<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="个人日记 nodejs学习。"><meta name="baidu-site-verification" content="7tp9tihrLG"><title>第五章 模板引擎 | 秋过冬漫长天亮中</title><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=1.0.0"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">第五章 模板引擎</h1><a id="logo" href="/.">秋过冬漫长天亮中</a><p class="description">没有比脚更长的路，走过去，前面是个天！</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">第五章 模板引擎</h1><div class="post-meta">Nov 24, 2016<span> | </span><span class="category"><a href="/categories/play-framework框架/">play framework框架</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/11/24/第五章-模板引擎/" href="/2016/11/24/第五章-模板引擎/#comments" class="ds-thread-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1模板语法"><span class="toc-text">5.1模板语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2模板继承"><span class="toc-text">5.2模板继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3模板标签详解"><span class="toc-text">5.3模板标签详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4Java对象扩展"><span class="toc-text">5.4Java对象扩展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5内置对象"><span class="toc-text">5.5内置对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6本章小结"><span class="toc-text">5.6本章小结</span></a></li></ol></div></div><div class="post-content"><p>Play具有高效的模板体系，采用Groovy作为其表达式语言，允许动态生成HTML、XML、JSON或者任何基于文本格式的文档，并且具有创建可重用标签（tag）的功能。模板储存在Play应用的app/views目录下。</p>
<h2 id="5-1模板语法"><a href="#5-1模板语法" class="headerlink" title="5.1模板语法"></a>5.1模板语法</h2><p> 与其他的语言一样，Play的模板也具有严格定义的语法。模板语法被划分为多种元素，用于完成不同类型的任务。Play模板的本质是普通的文本文件，其中带有占位符的部分可以生成动态内容。模板的动态部分采用Groovy语言编写，其语法与Java非常类似。框架可以将需要渲染的结果追加至HTTP响应的数据部分，并发送至模板。所有的动态部分将会在模板的执行期间被解析。 </p>
<p>(表5-1 模板语法)<br><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line">元素  描述  语法</div><div class="line">表达式 用于输出表达式的值。如 $&#123;note.title&#125; 的作用是将域对象note的属性title的值输出。 $<span class="meta">&#123;...&#125;</span></div><div class="line">标签  用于调用<span class="type">Play</span>框架内置的或是开发人员自定义的标签。如<span class="comment">#&#123;get 'title' /&#125;：获取变量 title 的值，该值仅在模板页面中有效。  #&#123;...&#125;</span></div><div class="line">引用  用于生成调用控制器中<span class="type">Action</span>方法的<span class="type">URL</span>，在页面链接中使用的最为频繁。@<span class="meta">&#123;...&#125;</span> 和 @@<span class="meta">&#123;...&#125;</span> 的区别在于生成的<span class="type">URL</span>分别是相对路径还是绝对路径。如：</div><div class="line"><span class="number">1</span>.&lt;a href=<span class="string">"@&#123;Application.index()&#125;"</span>首页&lt;/a：生成指向首页的链接。</div><div class="line"><span class="number">2</span>.@&#123;'/public/stylesheets/main.css'&#125;：引入<span class="type">CSS</span>静态资源文件。    @<span class="meta">&#123;...&#125;</span> 和@@<span class="meta">&#123;...&#125;</span></div><div class="line">国际化 用于显示经过国际化处理后的消息内容。  &amp;<span class="meta">&#123;...&#125;</span></div><div class="line">注释  用于在模板中添加注释。如：*&#123; 这是注释 &#125;*。    *<span class="meta">&#123;...&#125;</span>*</div><div class="line">脚本  用于添加复杂的 <span class="type">Groovy</span> 脚本，可以声明变量和执行业务逻辑。    %<span class="meta">&#123;...&#125;</span>%</div><div class="line"></div><div class="line"><span class="number">5</span>.<span class="number">1</span>.<span class="number">1</span> 表达式(expression):$&#123;…&#125;<span class="comment">#</span></div><div class="line"></div><div class="line">构建动态部分最简单的方法就是声明表达式。表达式需要以 $&#123; 开头， 并以 &#125; 结尾，作为占位符使用。具体例子如下：</div><div class="line"></div><div class="line">&lt;h1Client $&#123;client.name&#125;&lt;/h1</div><div class="line">以上是输出客户姓名的表达式例子。在该例子中，将客户类定义为<span class="type">Client</span>。经过控制器中<span class="type">Action</span>的业务逻辑执行，首先需要向模板注入对象client，之后就可以在模板中使用$&#123;…&#125;表达式语法输出client对象的name属性。</div><div class="line">如果不能确定向模板注入的client对象是否为null，可以使用如下<span class="type">Groovy</span>快捷语法：</div><div class="line"></div><div class="line">&lt;h1Client $&#123;client?.name&#125;&lt;/h1</div><div class="line">此时，只有client不为null的情况下，才进行client.name的输出。</div><div class="line"></div><div class="line"><span class="number">5</span>.<span class="number">1</span>.<span class="number">2</span> 标签(tag): <span class="comment">#&#123;tagName /&#125;#</span></div><div class="line"></div><div class="line">标签是能够附带参数调用的模板片段，如果标签只有一个参数，按照约定，参数的名称为arg，并且该参数名是可以省略的。例如，可以使用<span class="comment">#&#123;script&#125;标签加载JavaScript文件：</span></div><div class="line"><span class="comment">#&#123;script 'jquery.js' /&#125;</span></div><div class="line"><span class="type">Play</span>模板中的标签必须是闭合的，可以通过两种方式闭合标签。采用直接闭合的形式：</div><div class="line"></div><div class="line"><span class="comment">#&#123;script  'jquery.js'/&#125;</span></div><div class="line">或者起始标签和结束标签成对地使用：</div><div class="line"><span class="comment">#&#123;script  'jquery.js'&#125;#&#123;/script&#125;</span></div><div class="line"><span class="comment">#&#123;script&#125;是Play模板的内置标签，由框架实现，可以直接使用。后面会进一步介绍如何自定义标签来满足开发中一些特定的需求。#&#123;list&#125;标签可以对集合类进行迭代操作，使用时需要注意，必须带有两个参数（items以及as）：</span></div><div class="line">&lt;h1Client $&#123;client.name&#125;&lt;/h1</div><div class="line">&lt;ul</div><div class="line">    <span class="comment">#&#123;list items:client.accounts, as:'account' &#125;</span></div><div class="line">        &lt;li$&#123;account&#125;&lt;/li</div><div class="line">    <span class="comment">#&#123;/list&#125;</span></div><div class="line">&lt;/ul</div><div class="line">上例中使用<span class="comment">#&#123;list&#125;标签对client.accounts集合进行迭代，并将集合中的每一条数据作为account在页面中输出。</span></div><div class="line">在应用中，模板引擎默认对所有的动态表达式进行转义，以此来避免<span class="type">XSS</span>的安全问题。如果模板中变量$&#123;title&#125;的内容为&lt;h1Title&lt;/h1，在页面输出时会自动进行转义：</div><div class="line"></div><div class="line">$&#123;title&#125; -- &amp;lt;h1&amp;gt;<span class="type">Title</span>&amp;lt;/h1&amp;gt;</div><div class="line">也可以通过调用扩展方法raw()，以非转义的形式在页面中输出，具体使用方法如下：</div><div class="line"></div><div class="line">$&#123;title.raw()&#125; -- &lt;h1Title&lt;/h1</div><div class="line">如果需要显示大量的非转义<span class="type">HTML</span>内容，可以使用<span class="comment">#&#123;verbatim /&#125;标签：</span></div><div class="line"></div><div class="line"><span class="comment">#&#123;verbatim&#125;</span></div><div class="line">    $&#123;title&#125; -- &lt;h1Title&lt;/h1</div><div class="line"><span class="comment">#&#123;/verbatim&#125;</span></div><div class="line"></div><div class="line"><span class="number">5</span>.<span class="number">1</span>.<span class="number">3</span> 引用(action):@&#123;…&#125;或者@@&#123;…&#125;<span class="comment">#</span></div><div class="line"></div><div class="line">在前面的章节已经有过一些介绍，<span class="type">Play</span>通过路由器可以（逆向）生成<span class="type">URL</span>，匹配指定的路由。在模板中使用@&#123;…&#125;引用可以达到相同的目的：</div><div class="line"></div><div class="line">&lt;h1Client $&#123;client.name&#125;&lt;/h1</div><div class="line">&lt;p</div><div class="line">    &lt;a href=<span class="string">"@&#123;Clients.showAccounts(client.id)&#125;"</span><span class="type">All</span> accounts&lt;/a</div><div class="line">&lt;/p</div><div class="line">&lt;hr /</div><div class="line"></div><div class="line">&lt;a href=<span class="string">"@&#123;Clients.index()&#125;"</span><span class="type">Back</span>&lt;/a</div><div class="line">该实例中，@&#123;<span class="type">Clients</span>.showAccounts(client.id)&#125;调用了<span class="type">Clients</span>控制器中的showAccounts <span class="type">Action</span>方法，并传递了client.id参数。</div><div class="line">@@&#123;…&#125;引用的使用语法与@&#123;…&#125;相同，只不过生成的是绝对<span class="type">URL</span>（尤其适用于邮箱）。</div><div class="line"></div><div class="line"></div><div class="line"><span class="number">5</span>.<span class="number">1</span>.<span class="number">4</span> 国际化(messages):&amp;&#123;…&#125;<span class="comment">#</span></div><div class="line"></div><div class="line">如果应用需要进行国际化操作，那么可以在模板中使用&amp;<span class="meta">&#123;...&#125;</span>显示国际化信息。需要进行国际化的应用首先需要在conf/messages文件中进行国际化定义：</div><div class="line"></div><div class="line">clientName=<span class="type">The</span> client name <span class="keyword">is</span> %s</div><div class="line">之后在模板中就可以通过&amp;<span class="meta">&#123;...&#125;</span>显示该国际化信息了：</div><div class="line"></div><div class="line">&lt;h1&amp;&#123;'clientName',client.name&#125;&lt;/h1</div><div class="line"></div><div class="line"><span class="number">5</span>.<span class="number">1</span>.<span class="number">5</span> 注释(comment):*&#123;…&#125;*<span class="comment">#</span></div><div class="line"></div><div class="line">使用*&#123;…&#125;*标记的内容会被模板引擎忽略，起到注释作用：</div><div class="line">*&#123;**** <span class="type">Display</span> the user name ****&#125;*</div><div class="line">&lt;<span class="keyword">div</span> class=<span class="string">"name"</span></div><div class="line">    $&#123;user.name&#125;</div><div class="line">&lt;/<span class="keyword">div</span></div><div class="line"></div><div class="line"><span class="number">5</span>.<span class="number">1</span>.<span class="number">6</span> 脚本(script): %&#123;…&#125;%<span class="comment">#</span></div><div class="line"></div><div class="line">脚本是更加复杂的表达式集合，能够声明一些变量或者定义一些语句。<span class="type">Play</span>的模板中使用%&#123;…&#125;%插入脚本：</div><div class="line">%&#123;</div><div class="line">fullName = client.name.toUpperCase()+' '+client.forname;</div><div class="line">&#125;%</div><div class="line"> </div><div class="line">&lt;h1Client $&#123;fullName&#125;&lt;/h1</div><div class="line">也可以直接使用<span class="keyword">out</span>内置对象输出动态内容：</div><div class="line"></div><div class="line">%&#123;</div><div class="line">   fullName = client.name.toUpperCase()+' '+client.forname;</div><div class="line">   <span class="keyword">out</span>.print('&lt;h1'+fullName+'&lt;/h1');</div><div class="line">&#125;%</div><div class="line">在模板中还可以使用脚本编写结构化语句，执行一些逻辑操作，比如迭代：</div><div class="line"></div><div class="line">&lt;h1Client $&#123;client.name&#125;&lt;/h1</div><div class="line">&lt;ul</div><div class="line">%&#123;</div><div class="line">     <span class="keyword">for</span>(account <span class="keyword">in</span> client.accounts) &#123; </div><div class="line">&#125;%</div><div class="line">     &lt;li$&#123;account&#125;&lt;/li</div><div class="line">%&#123;</div><div class="line">     &#125;</div><div class="line">&#125;%</div><div class="line">&lt;/ul</div></pre></td></tr></table></figure></p>
<p>使用模板时切记：模板不适合处理复杂的业务逻辑，所以在模板中请尽量使用标签，或者直接将处理交给控制器或模型对象。</p>
<h2 id="5-2模板继承"><a href="#5-2模板继承" class="headerlink" title="5.2模板继承"></a>5.2模板继承</h2><p>Play提供继承机制为多模板之间进行页面布局或设计提供服务。#{extends /} 和 #{doLayout /}可以使页面的共享和重用变得更加方便简洁，同时也能够帮助开发人员实现页面中动态内容和静态外观装饰的分离。在模板与装饰之间可以使用#{get}和#{set}标签进行参数传递。<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">将simpledesign.html定义为父模板，也就是装饰模板。可以将页面中重用的静态内容定义在装饰模板中，如导航条、页面顶端的图片banner、页面底端的footer说明等。</div><div class="line"></div><div class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span> xml:lang=<span class="string">"en"</span> lang=<span class="string">"en"</span></div><div class="line">&lt;head</div><div class="line">    &lt;title#&#123;get <span class="string">'title'</span> /&#125;&lt;/title</div><div class="line">    &lt;link rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> href=<span class="string">"@&#123;'/public/stylesheets/main.css'&#125;"</span> /</div><div class="line">&lt;/head</div><div class="line"></div><div class="line">&lt;body</div><div class="line">    &lt;h1#&#123;get <span class="string">'title'</span> /&#125;&lt;/h1</div><div class="line">    #&#123;doLayout /&#125;</div><div class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"footer"</span>Built <span class="keyword">with</span> the play! framework&lt;/div</div><div class="line">&lt;/body</div><div class="line">&lt;/html</div><div class="line">在simpledesign.html中将&lt;head&lt;/head、&lt;h1&lt;/h1、&lt;div <span class="keyword">class</span>=<span class="string">"footer"</span>&lt;/div中的内容定义为公用元素，所有继承于该模板的页面都会包含这些内容。其中#&#123;doLayout /&#125;标签起到占位的作用，包含其子模板的页面内容。其他所有继承于simpledesign.html模板的页面内容都将显示在#&#123;doLayout /&#125;所占的页面区块。</div><div class="line">其他页面使用#&#123;extends&#125;标签可以非常简单地植入该装饰模板，具体使用方法如下：</div><div class="line"></div><div class="line">#&#123;extends <span class="string">'simpledesign.html'</span> /&#125;</div><div class="line"> </div><div class="line">#&#123;set title:<span class="string">'A decorated page'</span> /&#125;</div><div class="line">This content will be decorated.</div><div class="line">该子模板使用#&#123;extends <span class="string">'simpledesign.html'</span> /&#125;标签来继承simpledesign.html，使用#&#123;set title:<span class="string">'A decorated page'</span> /&#125;标签传递页面的title变量，最后在页面中输出This content will be decorated。</div></pre></td></tr></table></figure></p>
<h2 id="5-3模板标签详解"><a href="#5-3模板标签详解" class="headerlink" title="5.3模板标签详解"></a>5.3模板标签详解</h2><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div></pre></td><td class="code"><pre><div class="line">5.3.1 内置标签#</div><div class="line"></div><div class="line">由于Play采用的是MVC模型，这就要求表现层从请求处理和数据存储中分离开来。但是静态页面的功能毕竟是有限的，不能满足复杂的显示的需要，Play对一些常用的模板标签进行了封装，不仅实现了表现层和控制层的业务分离，还大大提升了模板功能的重用性。</div><div class="line">1. #&#123;<span class="ruby">a&#125;</span></div><div class="line"></div><div class="line">Play需要通过路由器（逆向）生成URL，以此来调用指定的Action。框架封装了HTML中的超链接标签&lt;a，可以方便地调用控制器中的Action，如：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">a @Application.index()&#125;</span> 首页 #&#123;<span class="ruby">/a&#125;</span></div><div class="line">该实例使用了内置标签#&#123;<span class="ruby">a&#125;</span>，可以生成指向控制器Application中index方法的HTML链接元素。在模板执行时，以上代码会被会解析为如下HTML代码：</div><div class="line">&lt;a href="/application/index "首页&lt;/a</div><div class="line">2.#&#123;<span class="ruby">authenticityToken /&#125;</span></div><div class="line"></div><div class="line">使用#&#123;<span class="ruby">authenticityToken /&#125;</span>标签可以防止跨站请求伪造，同时也能消除刷新提交和后退提交所带来的困扰。#&#123;<span class="ruby">authenticityToken /&#125;</span>首先会为服务器和客户端表单生成相同的随机令牌，并以隐藏的input输入域的形式嵌入表单。当用户点击submit按钮提交时，令牌会伴随着表单信息一并发送至控制器中的Action，在Action对提交的表单进行处理前，会先进行令牌的比对，只有令牌信息一致时，才进行后续的表单处理操作。在模板中可以直接使用#&#123;<span class="ruby">authenticityToken /&#125;</span>标签：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">authenticityToken /&#125;</span></div><div class="line">当为form表单添加了#&#123;<span class="ruby">authenticityToken /&#125;</span>标签后，HTML代码将会被解析为：</div><div class="line"></div><div class="line">&lt;input type="hidden" name="authenticityToken"</div><div class="line">       value="1c6d92fed96200347f06b7c5e1a3a28fa258ef7c"</div><div class="line">3.#&#123;<span class="ruby">cache&#125;</span></div><div class="line"></div><div class="line">Play的设计理念是无状态架构，不建议开发人员记录用户的状态。缓存是很好的解决方案，在开发中会被大量的用到，但缓存也有它自身的缺点，因为缓存只是存在于内存中，适用于存放暂时性的数据，时间一到就会过期。框架对缓存进行了封装，可以在模板中以标签的形式对缓存进行操作：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">cache <span class="string">'startTime'</span>&#125;</span></div><div class="line">   $&#123;new java.util.Date()&#125;</div><div class="line">#&#123;<span class="ruby">/cache&#125;</span></div><div class="line">上例中使用#&#123;<span class="ruby">cache&#125;</span>标签，将标签体内的日期进行缓存。还可以为#&#123;<span class="ruby">cache&#125;</span>标签添加for参数，设置缓存的过期时间：</div><div class="line">#&#123;<span class="ruby">cache <span class="string">'currentTime'</span>, <span class="symbol">for:</span><span class="string">'3s'</span>&#125;</span></div><div class="line">   $&#123;new java.util.Date()&#125;</div><div class="line">#&#123;<span class="ruby">/cache&#125;</span></div><div class="line">上例为#&#123;<span class="ruby">cache&#125;</span>标签添加了for参数，设置缓存的过期时间为3秒。</div><div class="line">4.#&#123;<span class="ruby">doLayout /&#125;</span></div><div class="line"></div><div class="line">Play引入了模板继承机制，假设定义装饰模板main.html，代码如下：</div><div class="line"></div><div class="line">&lt;!-- common header here --</div><div class="line">&lt;h1Main template&lt;/h1</div><div class="line"> </div><div class="line">&lt;div id="content"</div><div class="line">    #&#123;<span class="ruby">doLayout /&#125;</span></div><div class="line">&lt;/div</div><div class="line">&lt;!-- common footer here --</div><div class="line">#&#123;<span class="ruby">doLayout /&#125;</span>标签可以包含自身的页面内容，即表示在标签处可以插入子模板的内容。</div><div class="line">5.#&#123;<span class="ruby">extends&#125;</span></div><div class="line"></div><div class="line">子模板可以通过#&#123;<span class="ruby">extends&#125;</span>标签继承已经定义好的装饰模板。</div><div class="line"></div><div class="line">#&#123;<span class="ruby">extends <span class="string">'main.html'</span>/&#125;</span></div><div class="line"></div><div class="line">&lt;h1Some code&lt;/h1</div><div class="line">当子模板使用#&#123;<span class="ruby">extends&#125;</span>标签继承了main.html，就会包含父模板的内容。需要注意的是：在指定模板中别漏掉 #&#123;<span class="ruby">doLayout /&#125;</span>标签声明。</div><div class="line">6.#&#123;<span class="ruby"><span class="keyword">if</span>&#125;</span>，#&#123;<span class="ruby">ifnot&#125;</span>，#&#123;<span class="ruby">ifError&#125;</span>，#&#123;<span class="ruby">ifErrors&#125;</span></div><div class="line"></div><div class="line">在模板中使用#&#123;<span class="ruby"><span class="keyword">if</span>&#125;</span>标签可以进行条件判断：</div><div class="line"></div><div class="line">#&#123;<span class="ruby"><span class="keyword">if</span> user.countryCode == <span class="string">'en'</span> &#125;</span></div><div class="line">    Connected user is $&#123;user&#125;</div><div class="line">#&#123;<span class="ruby">/<span class="keyword">if</span>&#125;</span></div><div class="line">同时，#&#123;<span class="ruby"><span class="keyword">if</span>&#125;</span>标签还支持复杂的条件判断：</div><div class="line"></div><div class="line">#&#123;<span class="ruby"><span class="keyword">if</span> ( request.actionMethod == <span class="string">'administer'</span>  &amp;&amp; user.isAdmin() ) &#125;</span></div><div class="line">    You are admin, allowed to administer.</div><div class="line">#&#123;<span class="ruby">/<span class="keyword">if</span>&#125;</span></div><div class="line">#&#123;<span class="ruby">ifnot&#125;</span>标签顾名思义，就是ifnot的意思，其执行时具体的作用与#&#123;<span class="ruby"><span class="keyword">if</span> !condition&#125;</span>等价：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">ifnot tasks&#125;</span></div><div class="line">    No tasks today</div><div class="line">#&#123;<span class="ruby">/ifnot&#125;</span></div><div class="line">可能经常会遇到这种情况，经过控制器中Action的处理，向模板中注入验证错误的提示消息。#&#123;<span class="ruby">ifError&#125;</span>标签可以判断指定的作用域中是否有验证错误的信息：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">ifError <span class="string">'user.name'</span>&#125;</span></div><div class="line">  &lt;p</div><div class="line">    User name is invalid: </div><div class="line">    #&#123;<span class="ruby">error <span class="string">'user.name'</span> /&#125;</span></div><div class="line">  &lt;p</div><div class="line">#&#123;<span class="ruby">/ifError&#125;</span></div><div class="line">只要模板中有任何的验证错误信息，#&#123;<span class="ruby">ifErrors&#125;</span>标签都可以将其输出：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">ifErrors&#125;</span></div><div class="line">  &lt;pError(s) found!&lt;/p</div><div class="line">#&#123;<span class="ruby">/ifErrors&#125;</span></div><div class="line">7.#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span>，#&#123;<span class="ruby">elseif&#125;</span></div><div class="line">#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span>标签通常与#&#123;<span class="ruby"><span class="keyword">if</span>&#125;</span>标签配合使用：</div><div class="line"></div><div class="line">#&#123;<span class="ruby"><span class="keyword">if</span> user&#125;</span></div><div class="line">    Connected user is $&#123;user&#125;</div><div class="line">#&#123;<span class="ruby">/<span class="keyword">if</span>&#125;</span></div><div class="line">#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span></div><div class="line">    Please log in</div><div class="line">#&#123;<span class="ruby">/<span class="keyword">else</span>&#125;</span></div><div class="line">在Play的模板中，#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span>标签也可以与#&#123;<span class="ruby">list&#125;</span>标签一起使用，当使用#&#123;<span class="ruby">list &#125;</span>标签进行迭代的集合为空时，可以执行#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span>标签中的内容：</div><div class="line">#&#123;<span class="ruby">list <span class="symbol">items:</span>task, <span class="symbol">as:</span><span class="string">'task'</span>&#125;</span></div><div class="line">    &lt;li$&#123;task&#125;&lt;/li</div><div class="line">#&#123;<span class="ruby">/list&#125;</span></div><div class="line"> </div><div class="line">#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span></div><div class="line">    Nothing to do...</div><div class="line">#&#123;<span class="ruby">/<span class="keyword">else</span>&#125;</span></div><div class="line">#&#123;<span class="ruby">elseif&#125;</span>标签的作用同样是进行条件判断，用法与#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span>标签非常类似，也可以与#&#123;<span class="ruby">list&#125;</span>标签配合使用：</div><div class="line"></div><div class="line">#&#123;<span class="ruby"><span class="keyword">if</span> tasks.size()  <span class="number">1</span>&#125;</span></div><div class="line">    Busy tasklist</div><div class="line">#&#123;<span class="ruby">/<span class="keyword">if</span>&#125;</span></div><div class="line"> </div><div class="line">#&#123;<span class="ruby">elseif tasks&#125;</span></div><div class="line">    One task on the list</div><div class="line">#&#123;<span class="ruby">/elseif&#125;</span></div><div class="line"> </div><div class="line">#&#123;<span class="ruby"><span class="keyword">else</span>&#125;</span></div><div class="line">    Nothing to do</div><div class="line">#&#123;<span class="ruby">/<span class="keyword">else</span>&#125;</span></div><div class="line">8. #&#123;<span class="ruby">error&#125;</span>，#&#123;<span class="ruby">errorClass&#125;</span>，#&#123;<span class="ruby">errors&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">error&#125;</span>标签的作用是输出验证后的错误消息。如果指定字段的错误消息确实存在，则直接将其打印出来：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">error <span class="string">'user.name'</span>/&#125;</span></div><div class="line">#&#123;<span class="ruby">errorClass&#125;</span>标签的作用是如果存在指定的验证错误消息，则标签在解析时将被替换为文本hasError，以此可以用于设置出现错误后的HTML元素的样式。</div><div class="line"></div><div class="line">&lt;input name="name" class="#&#123;<span class="ruby">errorClass <span class="string">'name'</span>/&#125;</span>"</div><div class="line">在模板执行时，以上代码将会按照如下规则解析：</div><div class="line"></div><div class="line">&lt;input name="name" class="$&#123;errors.forKey('name') ? 'hasError' : ''&#125;"</div><div class="line">#&#123;<span class="ruby">errors&#125;</span>标签可以遍历当前的验证错误对象集合，其使用方式与 #&#123;<span class="ruby">list&#125;</span>非常类似，循环体中使用的对象变量名称是$&#123;error&#125;：</div><div class="line"></div><div class="line">&lt;ul</div><div class="line">#&#123;<span class="ruby">errors&#125;</span></div><div class="line">    &lt;li$&#123;error&#125;&lt;/li</div><div class="line">#&#123;<span class="ruby">/errors&#125;</span></div><div class="line">&lt;/ul</div><div class="line">#&#123;<span class="ruby">errors&#125;</span>的标签体内参数变量有以下几种：</div><div class="line"></div><div class="line">error：表示error对象。</div><div class="line">error_index：表示当前错误在集合中的序号。</div><div class="line">error_isLast：表示是否是集合中的最后一个错误。</div><div class="line">error_isFirst：表示是否是集合中的第一个错误。</div><div class="line">error_parity：表示当前错误在集合中序号的奇偶值，可能是even或odd。</div><div class="line">&lt;table</div><div class="line">    &lt;tr</div><div class="line">        &lt;th#&lt;/th</div><div class="line">        &lt;thError&lt;/th</div><div class="line">    &lt;/tr</div><div class="line">    #&#123;<span class="ruby">errors&#125;</span></div><div class="line">        &lt;tr class="$&#123;error_parity&#125;"</div><div class="line">            &lt;td$&#123;error_index&#125;&lt;/td</div><div class="line">            &lt;td$&#123;error&#125;&lt;/td</div><div class="line">        &lt;/tr</div><div class="line">    #&#123;<span class="ruby">/errors&#125;</span></div><div class="line">&lt;/table</div><div class="line">由于很多应用中表单的奇偶行的颜色是不同的，使用#&#123;<span class="ruby">errors&#125;</span>标签的error_parity参数就可以很方便的解决这个问题，这样有利于用户查看表单，用户体验性更强。</div><div class="line">9.#&#123;<span class="ruby">field&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">field&#125;</span>标签的作用非常大，本着Play的“简约”理念，#&#123;<span class="ruby">field&#125;</span>标签可以帮助开发者减少同一变量名的重复使用：</div><div class="line"></div><div class="line">&lt;p</div><div class="line">  &lt;label&amp;&#123;'user.name'&#125;&lt;/label</div><div class="line">  &lt;input type="text" id="user_name" name="user.name" value="$&#123;user.name&#125;" class="$&#123;errors.forKey('user.name') ? 'has_error' : ''&#125;"</div><div class="line">  &lt;span class="error"$&#123;errors.forKey('user.name')&#125;&lt;/span</div><div class="line">&lt;/p</div><div class="line">以上实例中，表单input输入中需要大量用到user.name。大量重复操作不仅给开发人员带来了不便，也使得页面的代码显得非常混乱。使用#&#123;<span class="ruby">field&#125;</span>标签很大程度上可以缓解这个问题:</div><div class="line"></div><div class="line">#&#123;<span class="ruby">field <span class="string">'user.name'</span>&#125;</span></div><div class="line">&lt;p</div><div class="line">  &lt;label&amp;&#123;field.name&#125;&lt;/label</div><div class="line">  &lt;input type="text" id="$&#123;field.id&#125;" name="$&#123;field.name&#125;" value="$&#123;field.value&#125;" class="$&#123;field.errorClass&#125;"</div><div class="line">  &lt;span class="error"$&#123;field.error&#125;&lt;/span</div><div class="line">&lt;/p</div><div class="line">#&#123;<span class="ruby">/&#125;</span></div><div class="line">Play提倡在页面开发中尽量使用#&#123;<span class="ruby">field&#125;</span>标签，而不是重复地编写变量名。</div><div class="line"></div><div class="line">10.#&#123;<span class="ruby">form&#125;</span></div><div class="line"></div><div class="line">Play的#&#123;<span class="ruby">form&#125;</span>标签封装了HTML中的&lt;form元素，在模板中插入#&#123;<span class="ruby">form&#125;</span>标签就等价于插入了表单元素。当在模板中使用了#&#123;<span class="ruby">form&#125;</span>标签时，Play会从路由配置中自动匹配已经定义好的HTTP方法：如果在路由配置中没有定义HTTP方法类型，则默认以POST方式请求；如果在路由配置中GET与POST都定义了，则默认以最先定义的HTTP方法执行。#&#123;<span class="ruby">form&#125;</span>标签中有以下三种参数：</div><div class="line"></div><div class="line">method（可选）：定义表单提交的HTTP方法类型，可以是POST或 GET。</div><div class="line">id（可选）：用于定义表单的id属性。</div><div class="line">enctype（可选）：设置表单数据编码方式，默认的编码方式为application/x-www-form-urlencoded。</div><div class="line"></div><div class="line">注意：</div><div class="line">Play中字符编码方式只能是utf-8。</div><div class="line"></div><div class="line">在Play模板中使用#&#123;<span class="ruby">form&#125;</span>标签的具体示例如下：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">form @Client.details(), <span class="symbol">method:</span><span class="string">'GET'</span>, <span class="symbol">id:</span><span class="string">'detailsForm'</span>&#125;</span></div><div class="line">   ...</div><div class="line">#&#123;<span class="ruby">/form&#125;</span></div><div class="line">在模板执行时，以上代码会被会解析为如下HTML代码：</div><div class="line"></div><div class="line">&lt;form action="/client/details" id="detailsForm" method="GET"</div><div class="line">      accept-charset="utf-8"</div><div class="line"> ...</div><div class="line">&lt;/form</div><div class="line">也可以指定目标实体，作为Action方法的一部分：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">form @Client.details(client.id)&#125;</span></div><div class="line">   ...</div><div class="line">#&#123;<span class="ruby">/form&#125;</span></div><div class="line">假设在控制器中，按照如下定义details方法。该方法中声明了String类型的参数，参数名为clientId。之后HTTP请求参数的名称会从声明的Action方法中匹配：</div><div class="line"></div><div class="line">public static void details(String clientId)&#123;</div><div class="line"><span class="comment">       // ...</span></div><div class="line">&#125;</div><div class="line">在模板代码解析时，Play会自动生成带clientId参数的URL地址：</div><div class="line"></div><div class="line">&lt;form action="/client/details?clientId=3442" method="GET"</div><div class="line">      accept-charset="utf-8"</div><div class="line"> ...</div><div class="line">&lt;/form</div><div class="line">需要着重介绍的一点是，在使用#&#123;<span class="ruby">form&#125;</span>标签以POST方式提交时，自带了令牌保护机制，也就是说#&#123;<span class="ruby">form&#125;</span>标签包含了#&#123;<span class="ruby">authenticityToken /&#125;</span>的功能：</div><div class="line">#&#123;<span class="ruby">form @Client.create(), <span class="symbol">method:</span><span class="string">'POST'</span>, <span class="symbol">id:</span><span class="string">'creationForm'</span>,</span></div><div class="line">       <span class="symbol">enctype:</span><span class="string">'multipart/form-data'</span> &#125;</div><div class="line">   ...</div><div class="line">#&#123;<span class="ruby">/form&#125;</span></div><div class="line">在模板执行时，以上代码会被会解析为如下HTML代码：</div><div class="line"></div><div class="line">&lt;form action="/client/create" id="creationForm" method="POST"</div><div class="line">      accept-charset="utf-8" enctype="multipart/form-data"</div><div class="line">&lt;input type="hidden" name="authenticityToken" </div><div class="line">       value="1c6d92fed96200347f06b7c5e1a3a28fa258ef7c"</div><div class="line"> ...</div><div class="line">&lt;/form</div><div class="line">11.#&#123;<span class="ruby">i18n&#125;</span></div><div class="line"></div><div class="line">i18n在模板中的用法比较特殊，不仅可以直接以标签的形式用于模板语言，也可以直接在JavaScript中调用。可以在JavaScript代码中使用i18n()方法来访问本地化消息文件，如i18n('app_title')。</div><div class="line"></div><div class="line">首先，需要在conf/messages中进行国际化定义：</div><div class="line"></div><div class="line">hello_world=Hello, World !</div><div class="line">hello_someone=Hello %s !</div><div class="line">之后，在模板中就可以插入#&#123;<span class="ruby">i18n /&#125;</span>标签来开启国际化支持了：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">i18n /&#125;</span></div><div class="line">在JavaScript中可以调用i18n()方法来进行国际化操作，通过conf/messages中的key获取当前key的国际化值：</div><div class="line"></div><div class="line">alert(i18n('hello_world'));</div><div class="line">alert(i18n('hello_someone', 'John'));</div><div class="line">还可以通过设置key的值来限制允许使用的国际化值，并且允许使用通配符来设置范围：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">i18n <span class="symbol">keys:</span>[<span class="string">'title'</span>, <span class="string">'menu.*'</span>] /&#125;</span></div><div class="line">12.#&#123;<span class="ruby"><span class="keyword">include</span>&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby"><span class="keyword">include</span>&#125;</span>标签的作用是在当前模板中导入另一个模板，并且当前模板中的所有变量对导入的模板透明。其具体使用方法如下：</div><div class="line"></div><div class="line">&lt;div id="tree"</div><div class="line">    #&#123;<span class="ruby"><span class="keyword">include</span> <span class="string">'tree.html'</span> /&#125;</span></div><div class="line">&lt;/div</div><div class="line">上例代码中，直接在当前模板中导入了tree.html模板。</div><div class="line">13.#&#123;<span class="ruby">render&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">render&#125;</span>标签的作用是指定模板进行渲染。#&#123;<span class="ruby">render&#125;</span>标签的参数是指定渲染模板的路径，可以是绝对路径，也可以是相对于/app/views的路径：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">render <span class="string">'Application/other.html'</span>/&#125;</span></div><div class="line">14.#&#123;<span class="ruby">jsAction&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">jsAction&#125;</span>标签会生成一个返回服务端Action的URL地址的JavaScript函数，它不会自动执行Ajax请求，需要通过返回的URL地址手动执行。具体的应用示例如下：</div><div class="line"></div><div class="line">首先在conf/routes文件中定义路由：</div><div class="line"></div><div class="line">GET     /users/&#123;id&#125;        Users.show</div><div class="line">之后，就可以在客户端导入定义好的路由：</div><div class="line"></div><div class="line">&lt;script type="text/javascript"</div><div class="line">    var showUserAction = #&#123;<span class="ruby">jsAction @Users.show(<span class="string">':id'</span>) /&#125;</span></div><div class="line">    </div><div class="line">    var displayUserDetail = function(userId) &#123;</div><div class="line">        $('userDetail').load( showUserAction(&#123;id: userId&#125;) )</div><div class="line">    &#125;</div><div class="line">&lt;/script</div><div class="line">有关Ajax的具体用法，会在第10.12节进行详细介绍。</div><div class="line">15.#&#123;<span class="ruby">list&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">list&#125;</span>标签提供非常简便的操作遍历对象集合：</div><div class="line"></div><div class="line">&lt;ul</div><div class="line">#&#123;<span class="ruby">list <span class="symbol">items:</span>products, <span class="symbol">as:</span><span class="string">'product'</span>&#125;</span></div><div class="line">    &lt;li$&#123;product&#125;&lt;/li</div><div class="line">#&#123;<span class="ruby">/list&#125;</span></div><div class="line">&lt;/ul</div><div class="line">其中#&#123;<span class="ruby">list <span class="symbol">items:</span>products, <span class="symbol">as:</span><span class="string">'product'</span>&#125;</span>用来遍历对象集合products，循环体中的每个对象用变量product来引用。在循环体的代码中可以引用一些预定义的变量，这些变量有固定的名称，但是会以循环体中的对象变量名作为前缀，在上面的例子中就是product_Xxx。#&#123;<span class="ruby">list&#125;</span>标签的预定义的变量有以下几种：</div><div class="line"></div><div class="line">note_index：表示当前对象在集合中的序号。</div><div class="line">note_isFirst：表示是否是集合中的第一个对象。</div><div class="line">note_isLast：表示是否是集合中的最后一个对象。</div><div class="line">note_parity：表示当前对象在集合中序号的奇偶值，可能是even或odd。</div><div class="line">&lt;ul</div><div class="line">#&#123;<span class="ruby">list <span class="symbol">items:</span>products, <span class="symbol">as:</span><span class="string">'product'</span>&#125;</span></div><div class="line">    &lt;span class="$&#123;product_parity&#125;"$&#123;product_index&#125;. $&#123;product&#125;&lt;/span</div><div class="line">    $&#123;product_isLast ? '' : '-'&#125;</div><div class="line">#&#123;<span class="ruby">/list&#125;</span></div><div class="line">&lt;/ul</div><div class="line">#&#123;<span class="ruby">list&#125;</span>标签中的items参数是可选的，也可以无需声明参数类型直接写参数，这样可以简化#&#123;<span class="ruby">list&#125;</span>标签的用法：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">list products, <span class="symbol">as:</span><span class="string">'product'</span>&#125;</span></div><div class="line">    &lt;li$&#123;product&#125;&lt;/li</div><div class="line">#&#123;<span class="ruby">/list&#125;</span></div><div class="line">在#&#123;<span class="ruby">list&#125;</span>标签中可以使用Groovy中的range对象，用法与for循环非常类似：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">list <span class="symbol">items:</span><span class="number">0</span>..<span class="number">10</span>, <span class="symbol">as:</span><span class="string">'i'</span>&#125;</span></div><div class="line">    $&#123;i&#125;</div><div class="line">#&#123;<span class="ruby">/list&#125;</span></div><div class="line">#&#123;<span class="ruby">list <span class="symbol">items:</span><span class="string">'a'</span>..<span class="string">'z'</span>, <span class="symbol">as:</span><span class="string">'letter'</span>&#125;</span></div><div class="line">    $&#123;letter&#125; $&#123;letter_isLast ? '' : '|' &#125;</div><div class="line">#&#123;<span class="ruby">/list&#125;</span></div><div class="line">#&#123;<span class="ruby">list&#125;</span>标签中as参数也不是必须的，可以用约定的下划线符“ _ ”作为默认的变量名：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">list users&#125;</span></div><div class="line">    &lt;li$&#123;_&#125;&lt;/li</div><div class="line">#&#123;<span class="ruby">/list&#125;</span></div><div class="line">16.#&#123;<span class="ruby">option&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">option&#125;</span>标签是HTML中&lt;option的封装，其作用是在当前模板位置中插入&lt;option元素。#&#123;<span class="ruby">option&#125;</span>标签的参数只有一个：</div><div class="line"></div><div class="line">value：选项的值。</div><div class="line">#&#123;<span class="ruby">option&#125;</span>标签的具体使用方法如下：</div><div class="line">#&#123;<span class="ruby">option user.id&#125;</span> $&#123;user.name&#125; #&#123;<span class="ruby">/option&#125;</span></div><div class="line">在模板执行时，以上代码会被会解析为如下HTML代码：</div><div class="line"></div><div class="line">&lt;option value="42"jto&lt;/option</div><div class="line">#&#123;<span class="ruby">option&#125;</span>标签一般与#&#123;<span class="ruby">select&#125;</span>标签配合使用。</div><div class="line">17.#&#123;<span class="ruby">select&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">select&#125;</span>标签是HTML中&lt;select的封装，其作用是在当前模板位置中插入&lt;select元素。#&#123;<span class="ruby">select&#125;</span>标签有一个必选的参数：</div><div class="line"></div><div class="line">name(必须)：设置select元素的name属性。</div><div class="line">其具体使用方法如下：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">select <span class="string">'booking.beds'</span>, <span class="symbol">value:</span><span class="number">2</span>, <span class="symbol">id:</span><span class="string">'select1'</span>&#125;</span></div><div class="line">    #&#123;<span class="ruby">option <span class="number">1</span>&#125;</span>One king-size bed#&#123;<span class="ruby">/option&#125;</span></div><div class="line">    #&#123;<span class="ruby">option <span class="number">2</span>&#125;</span>Two double beds#&#123;<span class="ruby">/option&#125;</span></div><div class="line">    #&#123;<span class="ruby">option <span class="number">3</span>&#125;</span>Three beds#&#123;<span class="ruby">/option&#125;</span></div><div class="line">#&#123;<span class="ruby">/select&#125;</span></div><div class="line">在模板执行时，以上代码会被会解析为如下HTML代码：</div><div class="line"></div><div class="line">&lt;select name="booking.beds" size="1" id="select1" </div><div class="line">    &lt;option value="1"One king-size bed&lt;/option</div><div class="line">    &lt;option value="2" selected="selected"Two double beds&lt;/option</div><div class="line">    &lt;option value="3"Three beds&lt;/option</div><div class="line">&lt;/select</div><div class="line">在#&#123;<span class="ruby">select&#125;</span>标签中使用items属性可以自动生成所需的option选择项：</div><div class="line"></div><div class="line">items(可选)：设置集合对象。</div><div class="line">value(可选)：设置默认选中项。</div><div class="line">labelProperty(可选)：设置每一项的lable值对应对象的哪个属性。</div><div class="line">valueProperty(可选)：设置每一项的value值对应对象的哪个属性，默认为对象的id属性。</div><div class="line"></div><div class="line">注意：</div><div class="line">labelProperty和valueProperty属性值不支持Java基本类型，需使用封装类型如Integer或Long来代替int或long类型 。</div><div class="line"></div><div class="line"></div><div class="line">以下代码为#&#123;<span class="ruby">select&#125;</span>标签中使用items属性的例子。首先由控制器Action向页面模板注入用户集合List&lt;User users，且每一个用户user都有name属性，id是User的主键：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">select <span class="string">'users'</span>, <span class="symbol">items:</span>users, <span class="symbol">valueProperty:</span><span class="string">'id'</span>, <span class="symbol">labelProperty:</span><span class="string">'name'</span>, <span class="symbol">value:</span><span class="number">5</span>, <span class="class"><span class="keyword">class</span>:'<span class="title">test</span>', <span class="title">id</span>:'<span class="title">select2</span>' /&#125;</span></span></div><div class="line">在模板执行时，以上代码会被会解析为如下HTML代码：</div><div class="line"></div><div class="line">&lt;select name="users" size="1" class="test" id="select2" </div><div class="line">  &lt;option value="0" User-0&lt;/option</div><div class="line">  &lt;option value="1" User-1&lt;/option            </div><div class="line">  &lt;option value="2" User-2&lt;/option            </div><div class="line">  &lt;option value="3" User-3&lt;/option</div><div class="line">  &lt;option value="4" User-4&lt;/option</div><div class="line">  &lt;option value="5" selected="selected"User-5&lt;/option</div><div class="line">&lt;/select</div><div class="line">18.#&#123;<span class="ruby">set&#125;</span>，#&#123;<span class="ruby">get&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">set&#125;</span>标签用于设置可以在模板中使用的变量。如#&#123;<span class="ruby">set <span class="symbol">email:</span><span class="string">'china@oopsplay.org'</span>&#125;</span>，就设置了模板变量email的值，可以通过 #&#123;<span class="ruby">get <span class="string">'email'</span>&#125;</span> 来获取。#&#123;<span class="ruby">set&#125;</span>标签的定义中可以引用其他变量：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">set <span class="symbol">title:</span><span class="string">'Profile of '</span> + user.login /&#125;</span></div><div class="line">还可以在#&#123;<span class="ruby">set&#125;</span>标签体内定义变量的值：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">set <span class="string">'title'</span>&#125;</span></div><div class="line">    Profile of $&#123;user.login&#125;</div><div class="line">#&#123;<span class="ruby">/set&#125;</span></div><div class="line">#&#123;<span class="ruby">get&#125;</span>标签的作用是获取由#&#123;<span class="ruby">set&#125;</span>标签定义的值，在Play的模板中，通过get/set机制，可以使父模板和子模板间进行通信。</div><div class="line"></div><div class="line">&lt;head</div><div class="line">    &lt;title#&#123;<span class="ruby">get <span class="string">'title'</span> /&#125;</span></div><div class="line">&lt;/head</div><div class="line">可以在#&#123;<span class="ruby">get&#125;</span>标签体内设置当变量不存在时的缺省值，如下例当title变量不存在时，会显示Homepage。</div><div class="line"></div><div class="line">&lt;head</div><div class="line">    &lt;title#&#123;<span class="ruby">get <span class="string">'title'</span>&#125;</span>Homepage #&#123;<span class="ruby">/&#125;</span> </div><div class="line">&lt;/head</div><div class="line">19.#&#123;<span class="ruby">script&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">script&#125;</span>标签用于生成一个&lt;script元素，可以引入/public/javascripts目录下的JavaScript文件。如 #&#123;<span class="ruby">script <span class="string">'jquery.js'</span>&#125;</span>就引用了/public/javascripts/jquery.js 文件。</div><div class="line"></div><div class="line">#&#123;<span class="ruby">script <span class="symbol">src:</span><span class="string">'jquery-1.5.1.min.js '</span>, <span class="symbol">id:</span><span class="string">'jquery'</span> , <span class="symbol">charset:</span><span class="string">'utf-8'</span> /&#125;</span></div><div class="line">#&#123;<span class="ruby">script&#125;</span>标签有以下几类参数：</div><div class="line">src(必须)：设置脚本文件的地址，无需在地址前加上默认父目录/public/javascripts。</div><div class="line">id(可选)：设置生成的&lt;script元素的id。</div><div class="line">charset(可选)：设置脚本文件的字符编码，默认为UTF-8。</div><div class="line">如果只需要在#&#123;<span class="ruby">script&#125;</span>标签中设置src的参数值，则可以省略src参数名，直接写上需要引入的JavaScript文件即可：</div><div class="line">#&#123;<span class="ruby">script <span class="string">'jquery-1.5.1.min.js'</span> /&#125;</span></div><div class="line">20.#&#123;<span class="ruby">stylesheet&#125;</span></div><div class="line"></div><div class="line">#&#123;<span class="ruby">stylesheet&#125;</span>标签的使用方法与#&#123;<span class="ruby">script&#125;</span>类似，不同的是#&#123;<span class="ruby">stylesheet&#125;</span>标签使用&lt;link元素来引入/public/stylesheets目录下的CSS文件。如#&#123;<span class="ruby">stylesheet <span class="symbol">id:</span><span class="string">'main'</span>, <span class="symbol">media:</span><span class="string">'print'</span>, <span class="symbol">src:</span><span class="string">'print.css'</span>, <span class="symbol">title:</span><span class="string">'Print stylesheet'</span> /&#125;</span>就引用了/public/stylesheets/print.js 文件。</div><div class="line"></div><div class="line">#&#123;<span class="ruby">stylesheet&#125;</span>标签有以下几类参数：</div><div class="line"></div><div class="line">src(必须)：设置样式文件的地址，无需在地址前加上默认父目录/public/stylesheets。</div><div class="line">id(可选)：设置生成的&lt;link标签的id。</div><div class="line">media(可选)：设置 media 属性: screen，print，aural，projection……</div><div class="line">title(可选)：设置标签title属性。</div><div class="line">如果只需要在#&#123;<span class="ruby">stylesheet&#125;</span>标签中设置src的参数值，则可以省略src参数名，直接写上需要引入的CSS文件即可：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">stylesheet <span class="string">'default.css'</span> /&#125;</span></div><div class="line">21.#&#123;<span class="ruby">verbatim&#125;</span></div><div class="line"></div><div class="line">使用#&#123;<span class="ruby">verbatim&#125;</span>标签可以禁用模板中的HTML转义功能。如果直接按照如下方式在模板中输出表达式：</div><div class="line"></div><div class="line">$&#123;'&amp;amp;'&#125; </div><div class="line">经模板解析后，会默认转义输出“&amp;amp ;”。如果使用了#&#123;<span class="ruby">verbatim&#125;</span>标签：</div><div class="line">#&#123;<span class="ruby">verbatim&#125;</span>$&#123;'&amp;amp;'&#125;#&#123;<span class="ruby">/verbatim&#125;</span></div><div class="line">模板解析时将不会进行转义，直接输出“&amp;”。</div><div class="line">5.3.2 自定义tag#</div><div class="line"></div><div class="line">Play提供了模板标签的自定义功能，可以非常方便地为应用创建特定的标签。这不仅提高了代码重用性，也使模板中的代码更加整洁。在这里提到的标签，指的就是简单的模板文件（存放在app/views/tags目录中），在使用时标签的名称需要与模板的文件名保持一致。</div><div class="line">具体使用方法如下。在app/views/tags目录中新建hello.html文件，即成功创建了hello标签，之后编辑hello.html中的内容：</div><div class="line"></div><div class="line">Hello from tag!</div><div class="line">并没有进行任何配置，就完成了标签的自定义，之后就可以在其他模板中直接使用该标签了：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">hello /&#125;</span></div><div class="line"></div><div class="line">获取标签参数</div><div class="line"></div><div class="line">在标签中可以包含参数，框架会自动将参数传递给模板变量。在使用中，标签的参数名与模板变量名并不是完全一致的，模板变量声明时需要增加下划线_。例如，在hello.html标签模板文件中进行如下声明：</div><div class="line"></div><div class="line">Hello $&#123;_name&#125;!</div><div class="line">在其他模板中，就可以通过如下语句将name参数传递给标签了：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">hello <span class="symbol">name:</span><span class="string">'Bob'</span> /&#125;</span></div><div class="line">如果标签中只有一个参数，就可以采用默认的参数名称arg。由于该名称是内置的，在使用时可以不显式地写出参数名。例如，在hello.html标签模板文件中声明：</div><div class="line"></div><div class="line">Hello $&#123;_arg&#125;!</div><div class="line">在其他模板中，简单地使用如下语句就可以将Bob传递给标签：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">hello <span class="string">'Bob'</span> /&#125;</span></div><div class="line"></div><div class="line">调用标签体</div><div class="line"></div><div class="line">起始标签和结束标签之间包含的内容称为标签体,标签体可以是文本，HTML等。在Play中调用#&#123;<span class="ruby">doBody /&#125;</span>标签可以很方便地完成以上内容。例如，在hello.html标签模板文件中声明：</div><div class="line"></div><div class="line">Hello #&#123;<span class="ruby">doBody /&#125;</span>!</div><div class="line">之后Ben将会作为标签体进行传递：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">hello&#125;</span></div><div class="line">    Ben</div><div class="line">#&#123;<span class="ruby">/hello&#125;</span></div><div class="line"></div><div class="line">自动选择最适标签</div><div class="line"></div><div class="line">根据content type设置，不同的页面可能会由不同的格式进行渲染(HTML，XML，JSON等)。这一点在Play中完全不用担心，框架会选取最适合的形式来显示。例如，当请求希望以HTML格式渲染时，Play会自动调用app/views/tags/hello.html模板；当请求希望以XML格式渲染时，Play则会选择app/views/tags/hello.xml模板。</div><div class="line"></div><div class="line">在Play中可以定义后缀为.tag的通用模板标签，但他的优先级是最低的。只有当规定的模板标签格式是无效时，才会调用它。例如，在程序中只定义了两个模板标签，分别是app/views/tags/hello.xml和app/views/tags/hello.tag，当请求希望以HTML格式渲染时，框架会优先寻找hello.html模板，当发现该文件不存在时，才会调用hello.tag模板。</div><div class="line"></div><div class="line">5.3.3 自定义Play标签#</div><div class="line"></div><div class="line">也可以在Java代码中自定义标签，封装一些更为复杂的功能。如果希望自定义Java标签，需要先创建继承于play.templates.FastTags的类。</div><div class="line"></div><div class="line">package utils;</div><div class="line"></div><div class="line">public class MyFastTag extends FastTags &#123;</div><div class="line">   ...</div><div class="line">&#125;</div><div class="line">每个想要作为标签(tag)运行的方法都具有固定的声明方式，具体如下：</div><div class="line">public static void _tagName(Map&lt;?, ? args, Closure body, PrintWriter out, </div><div class="line">   ExecutableTemplate template, int fromLine)</div><div class="line"></div><div class="line">注意：</div><div class="line">别漏了标签名前面的下划线。</div><div class="line"></div><div class="line"></div><div class="line">为了进一步了解如何创建标签，先来看看两个Play内置标签的例子(Play封装了这两个标签，在play/framework/src/play/templates/FastTags.java文件中可以查看）。</div><div class="line"></div><div class="line">#&#123;<span class="ruby">verbatim&#125;</span>标签只是简单的调用了从JavaExtensions传递过来的toString()方法，直接在模板上打印了标签体中的内容：</div><div class="line"></div><div class="line">public static void _verbatim(Map&lt;?, ? args, Closure body, PrintWriter out, </div><div class="line">   ExecutableTemplate template, int fromLine) &#123;</div><div class="line">   </div><div class="line">   out.println(JavaExtensions.toString(body));</div><div class="line">&#125;</div><div class="line">该标签的具体使用方法如下，从标签的开始到结束都是标签体内容：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">verbatim&#125;</span>My verbatim #&#123;<span class="ruby">/verbatim&#125;</span></div><div class="line">模板中将会打印出标签体内容：</div><div class="line"></div><div class="line">My verbatim</div><div class="line">第二个Play内置标签例子是#&#123;<span class="ruby">option&#125;</span>，它要稍微复杂一点，因为它的实现依赖于父标签#&#123;<span class="ruby">select&#125;</span>(Play也封装了#&#123;<span class="ruby">select&#125;</span>标签，在play/framework/templates/tags/select.tag文件中可以查看具体定义)。</div><div class="line">public static void _option(Map&lt;?, ? args, Closure body, PrintWriter out, </div><div class="line">      ExecutableTemplate template, int fromLine) &#123;</div><div class="line"> </div><div class="line">   Object value = args.get("arg");</div><div class="line">   Object selection = TagContext.parent("select").data.get("selected");</div><div class="line">   boolean selected = selection != null &amp;&amp; value != null </div><div class="line">      &amp;&amp; selection.equals(value);</div><div class="line"> </div><div class="line">   out.print("&lt;option value=\"" + (value == null ? "" : value) + "\" " </div><div class="line">      + (selected ? "selected=\"selected\"" : "") </div><div class="line">      + "" + serialize(args, "selected", "value") + "");</div><div class="line">   out.println(JavaExtensions.toString(body));</div><div class="line">   out.print("&lt;/option");</div><div class="line">&#125;</div><div class="line">      该Java标签的原理是封装了HTML的&lt;option标签，用于实现下拉列表实例，并且从父标签#&#123;<span class="ruby">select&#125;</span>中获取被默认选中(selected)的值。方法体最开始的三行用于设定输出的变量，最后的三行则输出了标签的结果。该标签的具体使用方法如下：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">select <span class="symbol">name:</span><span class="string">"country"</span>,<span class="symbol">value:</span><span class="string">"中国"</span>&#125;</span></div><div class="line">    #&#123;<span class="ruby">option <span class="symbol">arg:</span><span class="string">"英国"</span>&#125;</span>英国#&#123;<span class="ruby">/option&#125;</span></div><div class="line">    #&#123;<span class="ruby">option <span class="symbol">arg:</span><span class="string">"中国"</span>&#125;</span>中国#&#123;<span class="ruby">/option&#125;</span></div><div class="line">    #&#123;<span class="ruby">option <span class="symbol">arg:</span><span class="string">"美国"</span>&#125;</span>美国#&#123;<span class="ruby">/option&#125;</span></div><div class="line">    #&#123;<span class="ruby">option <span class="symbol">arg:</span><span class="string">"日本"</span>&#125;</span>日本#&#123;<span class="ruby">/option&#125;</span></div><div class="line">#&#123;<span class="ruby">/select&#125;</span></div><div class="line">这里需要对父标签#&#123;<span class="ruby">select&#125;</span>的使用做一些简单说明：country是#&#123;<span class="ruby">select&#125;</span>标签的name属性，是必选的；中国是#&#123;<span class="ruby">select&#125;</span>标签的value属性，用于标识selected元素，是可选的。</div><div class="line"></div><div class="line"></div><div class="line">标签的命名空间</div><div class="line"></div><div class="line">实际项目中可能会自定义大量的标签，标签命名不规范可能会造成一些不必要的麻烦(比如与已定义的标签重名，或是与Play框架的核心标签冲突)。为了解决这个问题，Play可以使用@FastTags.Namespace注解来设定命名空间。对于my.tags命名空间中的#&#123;<span class="ruby">hello&#125;</span>标签需要做以下工作：</div><div class="line"></div><div class="line">@FastTags.Namespace("my.tags") </div><div class="line">public class MyFastTag extends FastTags &#123;</div><div class="line">   public static void _hello (Map&lt;?, ? args, Closure body, PrintWriter out, </div><div class="line">      ExecutableTemplate template, int fromLine) &#123;</div><div class="line">      ...</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line">然后在模板中可以通过以下方式来调用#&#123;<span class="ruby">hello&#125;</span>标签：</div><div class="line"></div><div class="line">#&#123;<span class="ruby">my.tags.hello/&#125;</span></div></pre></td></tr></table></figure>
<h2 id="5-4Java对象扩展"><a href="#5-4Java对象扩展" class="headerlink" title="5.4Java对象扩展"></a>5.4Java对象扩展</h2><p>在模板引擎中使用Java对象是必不可少的，开发者还可以为其增加一些额外的方法。这些方法并没有定义在原始的Java类中，而是模板引擎动态添加的。例如，为了使模板中的数字进行格式化，可以为java.lang.Number对象增加format()方法，这样就可以非常简单地格式化数字：<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div></pre></td><td class="code"><pre><div class="line">&lt;ul</div><div class="line"><span class="comment">#&#123;list items:products, as:'product'&#125;</span></div><div class="line">    &lt;li$&#123;product.name&#125;. Price: $&#123;product.price.format(<span class="string">'## ###,00'</span>)&#125; €&lt;/li</div><div class="line"><span class="comment">#&#123;/list&#125;</span></div><div class="line">&lt;/ul</div><div class="line">以上例子展示了如何在模板引擎中使用format()方法对数字进行格式化操作。同样地，也可以对日期等其他Java对象进行格式化操作。</div><div class="line"><span class="number">5.4</span>.<span class="number">1</span> 内置扩展<span class="comment">#</span></div><div class="line"></div><div class="line">Java扩展为在视图层的模版中调用对象提供了更加便捷的方式，并让表达式可以表示更符合特定格式的内容。本小节是对Play内置Java扩展的介绍，通过对这些扩展相应实例的讲解，可以让开发者非常容易地实现自定义扩展。</div><div class="line"><span class="number">1.</span>集合扩展</div><div class="line"></div><div class="line">Play模板中的集合扩展主要有：join(separator)、pluralize()、pluralize(plural)、pluralize(singular, plural)、last()。</div><div class="line"></div><div class="line">(<span class="number">1</span>)join(separator)扩展的作用是使用给定的分隔符连接集合中的条目，其返回类型为String。可以将给定的分隔符作为join(separator)扩展的separator参数进行传递，具体的使用方法如下：</div><div class="line"></div><div class="line">$&#123;[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>].join(<span class="string">'/'</span>)&#125;</div><div class="line">针对给定的集合[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]使用join(<span class="string">'/'</span>)扩展，采用“/”符号将red、green、blue三个集合元素连接起来，运行结果为：</div><div class="line">red/green/blue</div><div class="line"></div><div class="line">(<span class="number">2</span>)pluralize()扩展的作用是区别集合的单复数显示形式。pluralize()扩展首先会进行判断，当集合的数量大于<span class="number">1</span>时，返回字符串+“s”（即英文语法中的复数）的形式，其返回类型为String。可以在模板中直接对某个集合使用pluralize()：</div><div class="line">colour$&#123;[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>].pluralize()&#125; </div><div class="line">对colour进行pluralize()扩展操作，由于集合[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]有三个元素，因此会显示colour的复数形式，运行结果为：</div><div class="line">colours</div><div class="line"></div><div class="line">(<span class="number">3</span>)pluralize(plural)扩展具有plural参数，其作用是指定集合为复数时展现的形式。当集合的数量不为<span class="number">1</span>时，该扩展方法将返回一个给定字符，以plural参数作为复数的后缀显示，其返回类型为String。pluralize(plural)扩展的使用方法与pluralize()类似：</div><div class="line"></div><div class="line">box$&#123;[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>].pluralize(<span class="string">'es'</span>)&#125;</div><div class="line">对box进行pluralize(<span class="string">'es'</span>)扩展操作，指定其复数的后缀为“es”，由于集合[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]有三个元素，因此会显示box的复数形式，运行结果为：</div><div class="line">boxes</div><div class="line"></div><div class="line">(<span class="number">4</span>)pluralize(singular, plural)扩展具有singular、plural两个参数，分别用于指定集合的单数和复数的表现形式，其返回类型为String。当集合中元素的数量为<span class="number">1</span>时，该扩展方法将以字符singular作为后缀，用于展现单数形式：</div><div class="line"></div><div class="line">journ$&#123;[<span class="string">'red'</span>].pluralize(<span class="string">'al'</span>, <span class="string">'aux'</span>)&#125;</div><div class="line">对journ进行pluralize(<span class="string">'al'</span>, <span class="string">'aux'</span>)扩展操作，由于集合中只有一个元素，故采用“al”后缀的单数表现形式，运行结果为：</div><div class="line">journal</div><div class="line"></div><div class="line">当集合中的元素数量大于<span class="number">1</span>时，该扩展方法将以字符plural作为后缀，用于展现复数形式：</div><div class="line">journ$&#123;[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>].pluralize(<span class="string">'al'</span>, <span class="string">'aux'</span>)&#125;</div><div class="line">对journ进行pluralize(<span class="string">'al'</span>, <span class="string">'aux'</span>)扩展操作，由于集合中有三个元素，故采用“aux”后缀的复数表现形式，运行结果为：</div><div class="line">journaux</div><div class="line"></div><div class="line">(<span class="number">5</span>)last()扩展的使用方法很简单，作用是返回集合中最后一个元素。由于集合中元素的数据类型未知，故其返回值为Object。</div><div class="line"></div><div class="line">$&#123;[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>].last()&#125;</div><div class="line">给定的集合[<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]中最后的一个元素为blue，last()扩展会将其返回，运行结果为：</div><div class="line">blue</div><div class="line"></div><div class="line"><span class="number">2.</span>日期扩展</div><div class="line"></div><div class="line">Play模板中的日期扩展主要有：format(format)、format(format, language)、since()、since(condition)。</div><div class="line"></div><div class="line">(<span class="number">1</span>)format(format)扩展的作用是根据给定的日期格式对字符串进行格式化，最后返回格式化后的日期，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="keyword">new</span> Date(<span class="number">1275910970000</span>).format(<span class="string">'dd MMMM yyyy hh:mm:ss'</span>)&#125;</div><div class="line">该扩展的format参数用于规定日期的格式，上例中format参数为“dd MMMM yyyy hh:mm:ss”，即将日期按照“日 月 年 时:分:秒”的格式进行处理，运行结果为：</div><div class="line"><span class="number">07</span> June <span class="number">2010</span> <span class="number">01</span>:<span class="number">42</span>:<span class="number">50</span></div><div class="line"></div><div class="line">(<span class="number">2</span>)format(format, language)扩展的作用与前面介绍的类似，不过具有format、language两个参数。其中format参数的功能相同，就不做过多的介绍了，language参数的作用是指定日期所采用的国际化语言(需要事先进行国际化配置)，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="keyword">new</span> Date(<span class="number">1275910970000</span>).format(<span class="string">'dd MMMM yyyy hh:mm:ss'</span>, <span class="string">'fr'</span>)&#125;</div><div class="line">该扩展按照“dd MMMM yyyy hh:mm:ss”规则格式化日期，并遵循fr法语国际化规则，运行结果为：</div><div class="line"><span class="number">07</span> juin <span class="number">2010</span> <span class="number">01</span>:<span class="number">42</span>:<span class="number">50</span></div><div class="line"></div><div class="line">(<span class="number">3</span>)since()扩展可以用于时刻的比较，即相对现在时刻将日期格式化为一个相对的时间，比如<span class="number">3</span>分钟之前(<span class="number">3</span> minutes ago)、<span class="number">1</span>天前(<span class="number">1</span> day ago)等等，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="keyword">new</span> Date(<span class="keyword">new</span> Date().getTime() - <span class="number">1000000</span>).since()&#125;</div><div class="line">在模板中使用<span class="keyword">new</span> Date().getTime()获得系统的当前时间，并将其减去<span class="number">1000000</span>毫秒(约等于<span class="number">16</span>分钟)，运行结果为：</div><div class="line"><span class="number">16</span> minutes ago</div><div class="line">since()扩展还有其他功能，可以利用以下的消息自定义相对时间的输出形式：since.seconds、since.minutes、since.hours、since.days、since.months以及since.years。</div><div class="line"></div><div class="line"></div><div class="line">(<span class="number">4</span>)since(condition)扩展的作用同样是格式化日期，将日期格式化为相对现在的某个时刻，其返回类型为String。如果给定的condition参数为<span class="literal">true</span>，只要相对的日期是在一个月之前，返回的String为那时的日期：</div><div class="line"></div><div class="line">$&#123;<span class="keyword">new</span> Date(<span class="number">1262350000000</span>).since(<span class="literal">true</span>)&#125;</div><div class="line">      since(condition)的condition参数为<span class="literal">true</span>，返回的String为相对时刻的日期，其运行结果为：</div><div class="line">Jan <span class="number">1</span>, <span class="number">2010</span></div><div class="line">      如果给定的condition参数为<span class="literal">false</span>，格式化的效果就与since()相同：</div><div class="line"></div><div class="line">$&#123;<span class="keyword">new</span> Date(<span class="number">1262350000000</span>).since(<span class="literal">false</span>)&#125;</div><div class="line">      其运行结果为：</div><div class="line"><span class="number">5</span> months ago</div><div class="line">      since(condition)扩展可以使用与since()相同的消息来自定义相对时间的输出形式，也可以使用since.format的方式自定义一个月之前的日期的输出形式。</div><div class="line"></div><div class="line"></div><div class="line"><span class="number">3.</span>长整型扩展</div><div class="line"></div><div class="line">      Play模板中的长整型扩展主要有：asdate(format)、asdate(format, language)以及formatSize()。</div><div class="line"></div><div class="line">      (<span class="number">1</span>)asdate(format)扩展的作用是将时间戳格式化为日期格式，其中format参数用于规定日期的格式，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="number">1275910970000.asdate</span>(<span class="string">'dd MMMM yyyy hh:mm:ss'</span>)&#125;</div><div class="line">      使用asdate(format)扩展对时间戳<span class="number">1275910970000</span>进行操作，运行结果为：</div><div class="line"><span class="number">07</span> June <span class="number">2010</span> <span class="number">01</span>:<span class="number">42</span>:<span class="number">50</span></div><div class="line"></div><div class="line">      (<span class="number">2</span>)asdate(format, language)扩展和format()的用法类似，使用给定的语言将时间戳格式化为日期。不同的是其具有format、language两个参数，其中format参数的功能相同，就不做过多的介绍了，language参数的作用是指定日期所采用的国际化语言(需要事先进行国际化配置)，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="number">1275910970000.asdate</span>(<span class="string">'dd MMMM yyyy hh:mm:ss'</span>, <span class="string">'fr'</span>)&#125;</div><div class="line">      遵循fr法语国际化规则，运行结果为：</div><div class="line"><span class="number">07</span> juin <span class="number">2010</span> <span class="number">01</span>:<span class="number">42</span>:<span class="number">50</span></div><div class="line"></div><div class="line">      (<span class="number">3</span>)formatSize()扩展的作用是将字节数格式化为文件大小，即以KB、MB、GB等单位表示长整型。</div><div class="line"></div><div class="line">$&#123;<span class="number">726016</span>L.formatSize()&#125;</div><div class="line">      对长整型<span class="number">726016</span>L进行格式化，运行结果为：</div><div class="line"><span class="number">709</span>KB</div><div class="line"></div><div class="line"><span class="number">4.</span>Map扩展</div><div class="line"></div><div class="line">      Play模板中的Map扩展主要有：asAttr()和asAttr(condition)。</div><div class="line"></div><div class="line">      (<span class="number">1</span>)Map对象是由“key/value”键值对的形式组成的，asAttr()扩展可以将Map对象中的key和value格式化为HTML中的属性，其返回类型为：play.templates.Template.ExecutableTemplate.RawData。</div><div class="line"></div><div class="line">$&#123;[id:<span class="string">'42'</span>, color:<span class="string">'red'</span>].asAttr()&#125;</div><div class="line">      该Map对象中有两组元素，使用asAttr()扩展进行处理，运行结果为：</div><div class="line">id=<span class="string">"42"</span> color=<span class="string">"red"</span> </div><div class="line">      (<span class="number">2</span>)asAttr(condition)扩展用法与asAttr()类似，当参数condition为<span class="literal">true</span>时，将Map对象中的key和value格式化为HTML中的属性，其返回类型为：play.templates.Template.ExecutableTemplate.RawData。</div><div class="line"></div><div class="line">$&#123;[id:<span class="string">'42'</span>, color:<span class="string">'red'</span>].asAttr(<span class="literal">true</span>)&#125;</div><div class="line">      运行结果</div><div class="line">id=<span class="string">"42"</span> color=<span class="string">"red"</span> </div><div class="line">      当参数condition为<span class="literal">false</span>时则不进行转化，模板中不会输出任何内容。</div><div class="line"></div><div class="line"><span class="number">5.</span>数字扩展</div><div class="line"></div><div class="line">      Play模板中的数字扩展主要有：divisibleBy(divisor)、format(format)、formatCurrency(currencyCode)以及page(pageSize)。</div><div class="line"></div><div class="line">      (<span class="number">1</span>)divisibleBy(divisor)扩展可以用于判断数字是否可以被给定的除数整除，其返回类型为boolean。divisibleBy(divisor)的divisor参数为除数，具体用法如下：</div><div class="line"></div><div class="line">$&#123;<span class="number">42.divisible</span>By(<span class="number">7</span>)&#125;</div><div class="line">      由于<span class="number">42</span>可以被<span class="number">7</span>整除，运行结果为：</div><div class="line"><span class="literal">true</span></div><div class="line"></div><div class="line">      (<span class="number">2</span>)format(format)扩展的作用是根据给定的格式对字符串进行格式化，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="number">42.format</span>(<span class="string">'000.00'</span>)&#125;</div><div class="line">      对数字<span class="number">42</span>进行格式化，规定整数部分不少于<span class="number">3</span>位，不足<span class="number">3</span>位前面补<span class="number">0</span>，保留两位小数，运行结果为：</div><div class="line"><span class="number">042.00</span></div><div class="line"></div><div class="line">      (<span class="number">3</span>)formatCurrency(currencyCode)扩展可以将数字根据给定的货币代码转化为货币表现形式，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="number">42.format</span>Currency(<span class="string">'EUR'</span>).raw()&#125;</div><div class="line">      货币代码EUR表示欧元，运行结果为：</div><div class="line">€ <span class="number">42.00</span> </div><div class="line"></div><div class="line">      (<span class="number">4</span>)page(pageSize)扩展主要用于页面的分页，可以根据给定的大小返回分页的页数，其返回类型为Integer。</div><div class="line"></div><div class="line">$&#123;<span class="number">42.page</span>(<span class="number">10</span>)&#125;</div><div class="line">      设置pageSize参数为<span class="number">10</span>，规定每页<span class="number">10</span>项，运行结果为：</div><div class="line"><span class="number">5</span></div><div class="line"></div><div class="line"><span class="number">6.</span>对象扩展</div><div class="line"></div><div class="line">      Play模板中的对象扩展主要有：addSlashes()、capAll()、capFirst()、cut(substring)、escape()、nl2br()、raw()、raw(condition)以及yesNo(<span class="string">'yes'</span>, <span class="string">'no'</span>)。</div><div class="line"></div><div class="line">      (<span class="number">1</span>)addSlashes()扩展的作用是为字符串对象中的单引号或双引号添加转义符，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"single quote (')"</span>.addSlashes().raw()&#125; $&#123;<span class="string">'double quote (")'</span>.addSlashes().raw()&#125;</div><div class="line">      分别为单引号和双引号添加转义符，运行结果为：</div><div class="line">single quote (<span class="string">\')</span> double quote (<span class="string">\")</span></div><div class="line"></div><div class="line">      (<span class="number">2</span>)capAll()扩展可以使字符串对象中每个单词的首字母变为大写，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"lorum ipsum dolor"</span>.capAll()&#125;</div><div class="line">      对字符串<span class="string">"lorum ipsum dolor"</span>进行每个单词首字母大写操作，运行结果为：</div><div class="line">Lorum Ipsum Dolor</div><div class="line"></div><div class="line">      (<span class="number">3</span>)capFirst()扩展可以使字符串对象中第一个单词的首字母变为大写，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"lorum ipsum dolor"</span>.capFirst()&#125;</div><div class="line">      对字符串<span class="string">"lorum ipsum dolor"</span>进行首字母大写操作，运行结果为：</div><div class="line">Lorum ipsum dolor</div><div class="line"></div><div class="line">      (<span class="number">4</span>)cut(substring)扩展可以从对象字符串中删除给定的子字符串，并返回删除后的字符串，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"lorum ipsum dolor"</span>.cut(<span class="string">'um'</span>)&#125;</div><div class="line">      如果给定的子字符串确实存在，则将其删除；如果不存在，则不做任何操作，运行结果为：</div><div class="line">lor ips dolor</div><div class="line"></div><div class="line">      (<span class="number">5</span>)escape()扩展可以将对象字符串中的HTML字符变为带转义符的形式，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"The &lt;blinktag&lt;/blink is evil"</span>.escape().raw()&#125;</div><div class="line">      使用escape()扩展后，查看页面源代码会发现字符串已经被转义，运行结果为：</div><div class="line">The &amp;lt;blink&amp;gt;tag&amp;lt;/blink&amp;gt; <span class="keyword">is</span> evil</div><div class="line"></div><div class="line">      (<span class="number">6</span>)nl2br()扩展的作用是将字符串对象中的‘<span class="string">\n’替换为HTML的&lt;br</span> /标签，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"one\ntwo"</span>.nl2br()&#125;</div><div class="line">      运行结果为：</div><div class="line">one&lt;br/two</div><div class="line"></div><div class="line">      (<span class="number">7</span>)raw()扩展会直接返回对象的内容，跳过模板转义处理，其返回类型为play.templates.Template.ExecutableTemplate.RawData。如果不使用raw()扩展，直接在模板上打印小于符号：</div><div class="line"></div><div class="line">$&#123;<span class="string">'&lt;'</span>&#125;</div><div class="line">      经过模板解析，运行结果为：</div><div class="line">&amp;lt;</div><div class="line">      为其添加raw()扩展：</div><div class="line">$&#123;<span class="string">'&lt;'</span>.raw()&#125;</div><div class="line">      在模板解析时，会自动跳过转义处理，运行结果为：</div><div class="line">&lt;</div><div class="line"></div><div class="line">      (<span class="number">8</span>)raw(condition)扩展与raw()用法类似，其返回类型为play.templates.Template.ExecutableTemplate.RawData。当给定的condtion参数为<span class="literal">true</span>时，跳过模板转义处理直接返回对象的内容；当给定的condtion参数为<span class="literal">false</span>时，不输出内容。</div><div class="line"></div><div class="line">$&#123;<span class="string">'&lt;'</span>.raw(<span class="literal">true</span>)&#125;</div><div class="line">      在模板解析时，会自动跳过转义处理，运行结果为：</div><div class="line">&lt;</div><div class="line"></div><div class="line">      (<span class="number">9</span>)yesNo(<span class="string">'yes'</span>, <span class="string">'no'</span>)扩展在使用时会进行判断，如果对象为真就返回第一个参数（<span class="string">'yes'</span>），反之则返回第二个参数（<span class="string">'no'</span>），其返回类型为Sring。</div><div class="line"></div><div class="line">$&#123;<span class="string">"not empty"</span>.yesno(<span class="string">'yes'</span>, <span class="string">'no'</span>)&#125;</div><div class="line">      运行结果为：</div><div class="line"><span class="literal">yes</span></div><div class="line"></div><div class="line"><span class="number">7.</span>字符串扩展</div><div class="line"></div><div class="line">      Play模板中的字符串扩展主要有：asXml()、camelCase()、capitalizeWords()、escapeHtml()、escapeJavaScript()、escapeXml()、noAccents()、pad(length)、slugify()以及urlEncode()。</div><div class="line"></div><div class="line">      (<span class="number">1</span>)asXml()扩展可以解析给定的XML字符串，如果符合XML文件的树状结构，将会输出结构标记的内容，其返回类型为groovy.util.slurpersupport.GPathResult。</div><div class="line"></div><div class="line">$&#123;<span class="string">"&lt;table&lt;tr&lt;tdred &lt;/td&lt;tdgreen &lt;/td&lt;tdblue &lt;/td&lt;/tr&lt;/table"</span>.asXml()&#125;</div><div class="line">      如果XML字符串格式正确，将会成功解析，运行结果如下，反之会出现模板错误警告：</div><div class="line">red green blue </div><div class="line"></div><div class="line">      (<span class="number">2</span>)camelCase()扩展将字符串格式化为camel形式（即骆驼命名法），这样可以使得代码更容易交流，可读性更强，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"lorum ipsum dolor"</span>.camelCase()&#125;</div><div class="line">      混合使用大小写字母来构成全新的字符串，运行结果为：</div><div class="line">LorumIpsumDolor</div><div class="line"></div><div class="line">      (<span class="number">3</span>)capitalizeWords()扩展可以使字符串中每个单词的首字母变为大写，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"lorum ipsum dolor"</span>.capitalizeWords()&#125;</div><div class="line">      对字符串<span class="string">"lorum ipsum dolor"</span>进行每个单词首字母大写操作，运行结果为：</div><div class="line">Lorum Ipsum Dolor</div><div class="line"></div><div class="line">      (<span class="number">4</span>)escapeHtml()扩展会将字符串中的HTML字符变为带转义符的形式，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"The &lt;blinktag&lt;/blink is evil"</span>.escapeHtml().raw()&#125;</div><div class="line">      运行结果为：</div><div class="line">The &amp;lt;blink&amp;gt;tag&amp;lt;/blink&amp;gt; <span class="keyword">is</span> evil</div><div class="line"></div><div class="line">      (<span class="number">5</span>)escapeJavaScript()扩展会将字符串中的JavaScript字符变为带转义符的形式，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"single quote (') double quote (\")"</span>.escapeJavaScript().raw()&#125;</div><div class="line">      运行结果为：</div><div class="line">single quote (<span class="string">\')</span> double quote (<span class="string">\")</span></div><div class="line"></div><div class="line">      (<span class="number">6</span>)escapeXml()扩展会将字符串中的XML字符变为带转义符的形式，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"&lt;\"&amp;"</span>.escapeXml().raw()&#125;</div><div class="line">      运行结果为：</div><div class="line">&amp;lt;&amp;gt;&amp;quot;&amp;amp;</div><div class="line"></div><div class="line">      (<span class="number">7</span>)noAccents()扩展的作用是将字符串中带有重音符号的字母替换为不带重音符号的字母，其返回类型为String。重音符号是指标识在字母上的附加符号，最典型的具有重音符号的语言就是法语。</div><div class="line"></div><div class="line">$&#123;<span class="string">"Stéphane Épardaud"</span>.noAccents()&#125;</div><div class="line">      带有重音符号的é和É都被转换，运行结果为：</div><div class="line">Stephane Epardaud</div><div class="line"></div><div class="line">      (<span class="number">8</span>)pad(length)扩展可以在字符串后增加HTML空格转义符，其中length-<span class="number">1</span>为指定HTML空格转义符个数的参数，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"x"</span>.pad(<span class="number">4</span>).raw()&#125;$&#123;<span class="string">"x"</span>&#125;</div><div class="line">      为字符串指定了<span class="number">4</span>个HTML空格转义符，运行结果为：</div><div class="line">x&amp;nbsp;&amp;nbsp;&amp;nbsp;x </div><div class="line"></div><div class="line">      (<span class="number">9</span>)slugify()扩展将字符串进行格式化，使用“-”将字符串中的每个单词连接，并将原有的标点符号丢弃，返回类型为String。该扩展主要用于生成URL，可以避免与URL的保留字符冲突。</div><div class="line"></div><div class="line">$&#123;<span class="string">"The Play! framework’s manual"</span>.slugify()&#125;</div><div class="line">      将原有字符串中的标点符号丢弃，使用“-”进行连接，运行结果为：</div><div class="line">the-play-framework-s-manual</div><div class="line"></div><div class="line">      (<span class="number">10</span>)urlEncode()扩展可以将URL查询字符串中用到的特殊符号转义输出，其返回类型为String。</div><div class="line"></div><div class="line">$&#123;<span class="string">"!@#\$%^&amp;()|"</span>.urlEncode()&#125;</div><div class="line">      该实例中的符号为URL查询字符串中常见的特殊符号，运行结果为：</div><div class="line">%<span class="number">21</span>%<span class="number">40</span>%<span class="number">23</span>%<span class="number">24</span>%<span class="number">25</span>%<span class="number">5E</span>%<span class="number">26</span>%<span class="number">28</span>%<span class="number">29</span>%<span class="number">7</span>C</div><div class="line"></div><div class="line"><span class="number">8.</span>字符串数组扩展</div><div class="line"></div><div class="line">      Play模板中的字符串数组扩展主要有：add(value)、contains(string)以及remove(string)。</div><div class="line"></div><div class="line">      (<span class="number">1</span>)add(value)扩展可以在数组末尾增加数据，其返回类型为String[]。</div><div class="line"></div><div class="line">$&#123;([<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"blue"</span>] as String[]).add(<span class="string">'pink'</span>).join(<span class="string">' '</span>)&#125;</div><div class="line">      为原有数组末尾添加“pink”元素，并使用join(<span class="string">' '</span>)扩展为数组元素之间添加空格符，运行结果为：</div><div class="line">red green blue pink</div><div class="line"></div><div class="line">      (<span class="number">2</span>)contains(string)扩展可以用于判断，如果数组中存在给定的字符串就返回<span class="literal">true</span>，反之则返回<span class="literal">false</span>，其返回类型为boolean。</div><div class="line"></div><div class="line">$&#123;([<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>] as String[]).contains(<span class="string">'green'</span>)&#125;</div><div class="line">      判断原有字符串数组中是否包含“green”元素，运行结果为：</div><div class="line"><span class="literal">true</span></div><div class="line"></div><div class="line">      (<span class="number">3</span>)remove(string)扩展可以删除字符串数组中给定的元素，并返回删除后的字符串数组，其返回类型为String[]。</div><div class="line"></div><div class="line">$&#123;([<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>] as String[]).remove(<span class="string">'green'</span>).join(<span class="string">' '</span>)&#125;</div><div class="line">      删除原有字符串数组中的“green”元素，并使用join(<span class="string">' '</span>)扩展为其添加空格符，运行结果为：</div><div class="line">red blue</div><div class="line">      如果需要删除的元素不存在，则不进行任何操作。</div><div class="line"></div><div class="line"><span class="number">5.4</span>.<span class="number">2</span> 创建自定义扩展<span class="comment">#</span></div><div class="line"></div><div class="line">      不同的项目往往需要特定的格式化需求，在这种情况下可以提供自己的扩展。Play对自定义扩展做了很好的封装，只需要创建继承于play.templates.JavaExtensions的Java类即可。下面将以自定义货币格式扩展为例进行讲解：</div><div class="line"></div><div class="line">package ext;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> play.templates.JavaExtensions;</div><div class="line"> </div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CurrencyExtensions</span> <span class="keyword">extends</span> <span class="title">JavaExtensions</span> &#123;</span></div><div class="line"> </div><div class="line">  public static String ccyAmount(Number number, String currencySymbol) &#123;</div><div class="line">     String format = <span class="string">"'"</span>+currencySymbol + <span class="string">"'#####.##"</span>;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">new</span> DecimalFormat(format).format(number);</div><div class="line">  &#125;</div><div class="line"> </div><div class="line">&#125;</div><div class="line">      在项目中创建ext包，用于存放该项目中的自定义扩展。在该目录下定义CurrencyExtensions类，并继承于JavaExtensions。读者在具体操作时需要注意，每个自定义的扩展方法均需要声明为static类型，并且返回类型为java.lang.String。定义的ccyAmount扩展方法中的第一个参数number是需要被格式化的对象，第二个参数currencySymbol是货币的符号，该扩展的具体使用方法如下：</div><div class="line"></div><div class="line">&lt;emPrice: $&#123;<span class="number">123456.324234</span>.ccyAmount(<span class="string">"€"</span>)&#125;&lt;/em</div><div class="line">      Play会在启动时自动检测这些模板扩展类，所以定义新扩展后只需重启应用就可以生效。</div></pre></td></tr></table></figure></p>
<h2 id="5-5内置对象"><a href="#5-5内置对象" class="headerlink" title="5.5内置对象"></a>5.5内置对象</h2><p> 所有添加到renderArgs作用域的对象，都会以变量的形式注入模板。比如，在控制器中将user对象注入模板：<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">renderArgs.put(<span class="string">"user"</span>,user);</div><div class="line">      当Action调用<span class="keyword">render</span>()方法进行模板渲染时，框架会同时将内置对象注入模板，这些内置对象可以直接在模板中使用，例如：</div><div class="line"></div><div class="line">$&#123;out.<span class="keyword">print</span>(<span class="string">"&lt;h1Hello World! &lt;/h1"</span>)&#125;</div><div class="line">      Play中所有的内置对象如表<span class="number">5.1</span>所示：</div><div class="line"></div><div class="line">(表<span class="number">5.1</span> 内置对象)</div><div class="line"></div><div class="line">变量  描述</div><div class="line">errors  验证错误信息结果集，对应<span class="keyword">play</span>.data.validation.Validation.errors()</div><div class="line">flash   Flash作用域，对应<span class="keyword">play</span>.mvc.Scope.Flash</div><div class="line">lang    当前使用的语言，对应<span class="keyword">play</span>.i18n.Lang</div><div class="line">messages    消息映射变量，对应<span class="keyword">play</span>.i18n.Messages</div><div class="line">out 引用页面输出流，对应java.io.PrintWriter</div><div class="line">params  当前参数变量，对应<span class="keyword">play</span>.mvc.Scope.Params</div><div class="line"><span class="keyword">play</span>    Play框架类，对应<span class="keyword">play</span>.Play</div><div class="line">request 当前请求对象，对应<span class="keyword">play</span>.mvc.Http.Request</div><div class="line">session Session作用域，对应<span class="keyword">play</span>.mvc.Scope.Session</div><div class="line">      除了表<span class="number">5.1</span>列出的这些内置对象之外，Groovy还保留了owner，delegate和it，所有这些保留字都不能在模板中作为自定义变量使用。</div></pre></td></tr></table></figure></p>
<h2 id="5-6本章小结"><a href="#5-6本章小结" class="headerlink" title="5.6本章小结"></a>5.6本章小结</h2><blockquote>
<p>本章介绍了Play的高效模板引擎机制。除了自身提供简单易用的标签外，我们还可以自定义标签来实现视图代码的重用，相信读者也已经感受到了开发的乐趣。相比传统的表现层jsp，Play的模板与对象之间的调用更加直接。模板继承，自定义扩展，这些特性使得视图的开发更加灵活，层次更加清晰。由于模板代码崇尚“简洁，直接”的原则，很大程度上提高了代码的可维护性。</p>
</blockquote>
</div><div class="tags"><a href="/tags/play/">play</a></div><div class="post-nav"><a href="/2016/11/23/第四章-控制层/" class="next">第四章 控制层</a></div><div data-thread-key="2016/11/24/第五章-模板引擎/" data-title="第五章 模板引擎" data-url="http://lisxweb.github.io/2016/11/24/第五章-模板引擎/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/11/24/第五章-模板引擎/" data-title="第五章 模板引擎" data-url="http://lisxweb.github.io/2016/11/24/第五章-模板引擎/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="widget"><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入关键字..."/></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux服务器/">Linux服务器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MAC实用/">MAC实用</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/play-framework框架/">play framework框架</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/Linux服务器/" style="font-size: 15px;">Linux服务器</a> <a href="/tags/play/" style="font-size: 15px;">play</a> <a href="/tags/MAC-Eclipse-快捷键/" style="font-size: 15px;">MAC Eclipse 快捷键</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-fei"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/11/24/第五章-模板引擎/">第五章 模板引擎</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/第四章-控制层/">第四章 控制层</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/第三章-路由语法/">第三章 路由语法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/21/整理MAC下Eclipse的常用快捷键/">整理MAC下Eclipse的常用快捷键</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/21/Linux服务器增量备份脚步/">Linux服务器增量备份脚本</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/18/第二章-基础概念/">第二章 基础概念</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/17/第一章-绪论/">第一章 绪论</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/17/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-commt"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><a id="totop" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |<a href="/atom.xml">订阅本站</a> |<span>联系博主：<a href="mailto:zhenggchaoo@gmail.com" target="_blank" class="fa fa-email"> </a><a href="http://weibo.com/zhengchaooo" target="_blank" class="fa fa-weibo"></a><a href="https://github.com/chaooo" target="_blank" class="fa fa-github"> </a></span></p><p><span> Copyright &copy;<a href="/." rel="nofollow">lisxweb</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span><span><a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> Theme </a>by<a rel="nofollow" target="_blank" href="https://github.com/chaooo"> Charles.</a></span></p></div></div></div><script>var duoshuoQuery = {short_name:'lisx'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    document.getElementsByTagName('body')[0].appendChild(ds);
})();
</script><script type="text/javascript" src="/js/search.json.js?v=1.0.0"></script></body></html>